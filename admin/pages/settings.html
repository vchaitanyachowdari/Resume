<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Settings ‚Äî VC Admin</title>
    <meta name="robots" content="noindex, nofollow" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="../css/admin.css" />
</head>

<body>
    <div class="admin-shell">
        <div id="sidebarMount"></div>
        <div class="main-wrapper">
            <header class="topbar">
                <div class="topbar-left">
                    <button class="topbar-btn" style="display:none" id="mobileSidebarBtn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="3" y1="6" x2="21" y2="6" />
                            <line x1="3" y1="12" x2="21" y2="12" />
                            <line x1="3" y1="18" x2="21" y2="18" />
                        </svg>
                    </button>
                    <div>
                        <h2 class="page-title">Settings</h2>
                        <div class="breadcrumb">Dashboard <span>‚Ä∫</span> Settings</div>
                    </div>
                </div>
                <div class="topbar-right">
                    <button class="topbar-btn" id="themeToggle"><span class="theme-icon">‚òÄÔ∏è</span></button>
                    <div class="topbar-user" data-dropdown="topDrop" style="position:relative">
                        <div class="user-avatar" style="width:30px;height:30px;font-size:12px"><span
                                class="user-initials">VC</span></div>
                        <span class="topbar-user-name user-display-name">V Chaitanya</span>
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="6 9 12 15 18 9" />
                        </svg>
                        <div class="dropdown-menu" id="topDrop">
                            <div class="dropdown-item danger" data-logout>üö™ Logout</div>
                        </div>
                    </div>
                </div>
            </header>

            <main class="page-content">
                <div class="page-header">
                    <div class="page-header-left">
                        <h1>Settings</h1>
                        <p>Manage your profile and site configuration</p>
                    </div>
                </div>

                <div class="grid-2" style="align-items:start">
                    <!-- LEFT: Profile + Social + Password -->
                    <div style="display:flex;flex-direction:column;gap:20px">

                        <!-- Profile Settings -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üë§ Profile Settings</h3>
                            </div>

                            <div
                                style="display:flex;align-items:center;gap:20px;margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid var(--border-subtle)">
                                <div class="user-avatar" id="avatarPreview"
                                    style="width:72px;height:72px;font-size:26px;flex-shrink:0">VC</div>
                                <div>
                                    <div style="font-weight:700;font-size:15px;margin-bottom:4px" id="previewName">V
                                        Chaitanya</div>
                                    <div style="color:var(--text-muted);font-size:13px;margin-bottom:10px"
                                        id="previewRole">Super Admin</div>
                                    <input type="url" class="form-input" id="sAvatarUrl" placeholder="Profile image URL"
                                        style="font-size:13px;padding:7px 12px" />
                                </div>
                            </div>

                            <div class="form-row-2">
                                <div class="form-group">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-input" id="sName" placeholder="Your full name" />
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-input" id="sEmail" placeholder="admin@vc.com" />
                                </div>
                            </div>
                            <div class="form-row-2">
                                <div class="form-group">
                                    <label class="form-label">Phone</label>
                                    <input type="text" class="form-input" id="sPhone" placeholder="+91 99999 00000" />
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Location</label>
                                    <input type="text" class="form-input" id="sLocation"
                                        placeholder="Hyderabad, India" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Bio</label>
                                <textarea class="form-textarea" id="sBio" rows="3"
                                    placeholder="Brief about yourself..."></textarea>
                            </div>
                            <div class="form-group" style="display:flex;align-items:center;gap:12px">
                                <label class="toggle-switch">
                                    <div class="toggle-track" id="openToWorkTrack">
                                        <div class="toggle-thumb"></div>
                                    </div>
                                </label>
                                <div>
                                    <div style="font-size:13px;font-weight:600;color:var(--text-primary)">Open to Work
                                    </div>
                                    <div style="font-size:12px;color:var(--text-muted)">Show "Available for hire" badge
                                        on portfolio</div>
                                </div>
                                <input type="checkbox" id="sOpenToWork" style="display:none" />
                            </div>
                            <button class="btn btn-primary w-full" onclick="saveProfile()">üíæ Save Profile</button>
                        </div>

                        <!-- Social Links -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üîó Social Links</h3>
                            </div>
                            <div class="form-group">
                                <label class="form-label">GitHub URL</label>
                                <input type="url" class="form-input" id="sGithub"
                                    placeholder="https://github.com/username" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">LinkedIn URL</label>
                                <input type="url" class="form-input" id="sLinkedin"
                                    placeholder="https://linkedin.com/in/username" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">Twitter / X URL</label>
                                <input type="url" class="form-input" id="sTwitter"
                                    placeholder="https://twitter.com/username" />
                            </div>
                            <button class="btn btn-primary w-full" onclick="saveSocial()">üíæ Save Social Links</button>
                        </div>

                        <!-- Change Password -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üîí Change Password</h3>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Current Password</label>
                                <input type="password" class="form-input" id="pwCurrent" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                    autocomplete="current-password" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">New Password</label>
                                <input type="password" class="form-input" id="pwNew" placeholder="Min 8 characters"
                                    autocomplete="new-password" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">Confirm New Password</label>
                                <input type="password" class="form-input" id="pwConfirm"
                                    placeholder="Repeat new password" autocomplete="new-password" />
                            </div>
                            <button class="btn btn-primary w-full" onclick="changePassword()">üîë Update
                                Password</button>
                        </div>
                    </div>

                    <!-- RIGHT: Site Settings + Danger Zone -->
                    <div style="display:flex;flex-direction:column;gap:20px">

                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">üåê Site Settings</h3>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Site Title</label>
                                <input type="text" class="form-input" id="sSiteTitle"
                                    placeholder="Your Portfolio Title" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">Tagline</label>
                                <input type="text" class="form-input" id="sTagline"
                                    placeholder="Developer ¬∑ Designer ¬∑ Builder" />
                            </div>
                            <div class="form-group">
                                <label class="form-label">Meta Description</label>
                                <textarea class="form-textarea" id="sMetaDesc" rows="3"
                                    placeholder="Short description for search engines..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Meta Keywords</label>
                                <input type="text" class="form-input" id="sMetaKw"
                                    placeholder="react, developer, AI, portfolio" />
                            </div>
                            <button class="btn btn-primary w-full" onclick="saveSite()">üíæ Save Site Settings</button>
                        </div>

                        <!-- Danger Zone -->
                        <div class="card" style="border-color:rgba(239,68,68,0.2)">
                            <div class="card-header">
                                <h3 class="card-title" style="color:var(--accent-red)">‚ö†Ô∏è Danger Zone</h3>
                            </div>
                            <p style="font-size:13px;color:var(--text-secondary);margin-bottom:16px">These actions are
                                irreversible. Proceed with caution.</p>
                            <div style="display:flex;flex-direction:column;gap:12px">
                                <div
                                    style="display:flex;align-items:center;justify-content:space-between;padding:14px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.15);border-radius:var(--radius-sm);gap:12px">
                                    <div>
                                        <div style="font-size:13px;font-weight:600;color:var(--text-primary)">Reset All
                                            Mock Data</div>
                                        <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Wipe all CMS
                                            data from localStorage</div>
                                    </div>
                                    <button class="btn btn-danger btn-sm" onclick="confirmReset()">Reset</button>
                                </div>
                                <div
                                    style="display:flex;align-items:center;justify-content:space-between;padding:14px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.15);border-radius:var(--radius-sm);gap:12px">
                                    <div>
                                        <div style="font-size:13px;font-weight:600;color:var(--text-primary)">Logout All
                                            Sessions</div>
                                        <div style="font-size:12px;color:var(--text-muted);margin-top:2px">Clear session
                                            and redirect to login</div>
                                    </div>
                                    <button class="btn btn-danger btn-sm" data-logout>Logout</button>
                                </div>
                            </div>
                        </div>

                        <!-- System Info -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">‚ÑπÔ∏è System Info</h3>
                            </div>
                            <div style="display:flex;flex-direction:column;gap:10px;font-size:13px">
                                <div
                                    style="display:flex;justify-content:space-between;padding-bottom:10px;border-bottom:1px solid var(--border-subtle)">
                                    <span style="color:var(--text-muted)">Portal Version</span>
                                    <span style="font-weight:600">v1.0.0</span>
                                </div>
                                <div
                                    style="display:flex;justify-content:space-between;padding-bottom:10px;border-bottom:1px solid var(--border-subtle)">
                                    <span style="color:var(--text-muted)">Backend</span>
                                    <span class="badge badge-yellow">‚öôÔ∏è Appwrite (Pending)</span>
                                </div>
                                <div
                                    style="display:flex;justify-content:space-between;padding-bottom:10px;border-bottom:1px solid var(--border-subtle)">
                                    <span style="color:var(--text-muted)">Storage</span>
                                    <span class="badge badge-green">‚úÖ localStorage (Mock)</span>
                                </div>
                                <div style="display:flex;justify-content:space-between">
                                    <span style="color:var(--text-muted)">Last Saved</span>
                                    <span id="lastSaved" style="font-weight:600">‚Äî</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- RESET CONFIRM -->
    <div class="modal-overlay" id="resetModal">
        <div class="modal modal-sm">
            <div class="modal-body" style="text-align:center;padding-top:32px">
                <div class="confirm-icon">‚ö†Ô∏è</div>
                <div class="confirm-title">Reset All Data?</div>
                <p class="confirm-text">All projects, skills, experience, education, messages and media data will be
                    reset to defaults. This cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="Modal.hide('resetModal')">Cancel</button>
                <button class="btn btn-danger" onclick="doReset()">Yes, Reset Everything</button>
            </div>
        </div>
    </div>

    <script src="../js/admin.js"></script>
    <script src="../js/sidebar.js"></script>
    <script>
        Auth.requireAuth('../login.html');
        initPage();

        // Load settings
        const s = CMS.get('settings');
        document.getElementById('sName').value = s.siteName?.replace('V Chaitanya Chowdari ‚Äî ', '') || 'V Chaitanya';
        document.getElementById('sEmail').value = s.email || '';
        document.getElementById('sPhone').value = s.phone || '';
        document.getElementById('sLocation').value = s.location || '';
        document.getElementById('sBio').value = s.bio || '';
        document.getElementById('sSiteTitle').value = s.siteTitle || '';
        document.getElementById('sTagline').value = s.tagline || '';
        document.getElementById('sMetaDesc').value = s.metaDesc || '';
        document.getElementById('sMetaKw').value = s.metaKeywords || '';
        document.getElementById('sGithub').value = s.githubUrl || '';
        document.getElementById('sLinkedin').value = s.linkedinUrl || '';
        document.getElementById('sTwitter').value = s.twitterUrl || '';

        const openTrack = document.getElementById('openToWorkTrack');
        const openInput = document.getElementById('sOpenToWork');
        openInput.checked = s.openToWork;
        openTrack.classList.toggle('on', s.openToWork);
        openTrack.addEventListener('click', () => {
            openInput.checked = !openInput.checked;
            openTrack.classList.toggle('on', openInput.checked);
        });

        // Avatar preview
        document.getElementById('sAvatarUrl').addEventListener('input', function () {
            const av = document.getElementById('avatarPreview');
            if (this.value) {
                av.innerHTML = `<img src="${this.value}" style="width:100%;height:100%;object-fit:cover;border-radius:50%" onerror="this.parentElement.textContent='VC'" />`;
            } else {
                av.textContent = 'VC';
            }
        });

        function saveProfile() {
            const updates = {
                siteName: 'V Chaitanya Chowdari ‚Äî Portfolio',
                email: document.getElementById('sEmail').value.trim(),
                phone: document.getElementById('sPhone').value.trim(),
                location: document.getElementById('sLocation').value.trim(),
                bio: document.getElementById('sBio').value.trim(),
                openToWork: openInput.checked,
                avatarUrl: document.getElementById('sAvatarUrl').value.trim(),
            };
            const existing = CMS.get('settings');
            CMS.set('settings', { ...existing, ...updates });
            document.getElementById('lastSaved').textContent = 'Just now';
            Toast.success('Profile settings saved!');
        }

        function saveSocial() {
            const existing = CMS.get('settings');
            CMS.set('settings', {
                ...existing,
                githubUrl: document.getElementById('sGithub').value.trim(),
                linkedinUrl: document.getElementById('sLinkedin').value.trim(),
                twitterUrl: document.getElementById('sTwitter').value.trim(),
            });
            Toast.success('Social links saved!');
        }

        function saveSite() {
            const existing = CMS.get('settings');
            CMS.set('settings', {
                ...existing,
                siteTitle: document.getElementById('sSiteTitle').value.trim(),
                tagline: document.getElementById('sTagline').value.trim(),
                metaDesc: document.getElementById('sMetaDesc').value.trim(),
                metaKeywords: document.getElementById('sMetaKw').value.trim(),
            });
            document.getElementById('lastSaved').textContent = 'Just now';
            Toast.success('Site settings saved!');
        }

        function changePassword() {
            const cur = document.getElementById('pwCurrent').value;
            const nw = document.getElementById('pwNew').value;
            const conf = document.getElementById('pwConfirm').value;
            if (!cur || !nw || !conf) { Toast.error('All password fields are required'); return; }
            if (nw.length < 8) { Toast.error('New password must be at least 8 characters'); return; }
            if (nw !== conf) { Toast.error('Passwords do not match'); return; }
            ['pwCurrent', 'pwNew', 'pwConfirm'].forEach(id => document.getElementById(id).value = '');
            Toast.success('Password updated! (Will sync to Appwrite when connected)');
        }

        function confirmReset() { Modal.show('resetModal'); }
        function doReset() {
            Object.keys(CMS.KEYS).forEach(k => localStorage.removeItem(CMS.KEYS[k]));
            Modal.hide('resetModal');
            Toast.success('All data reset to defaults');
            setTimeout(() => location.reload(), 1200);
        }
    </script>
</body>

</html>